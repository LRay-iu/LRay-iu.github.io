<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="Patrick Collins-åŒºå—é“¾å­¦ä¹ ç¬”è®°">
  
  <title>
    Gin ç¬”è®° |
    
    LRayçš„åšå®¢
  </title>
  <!-- Icon -->
  
    <link rel="shortcut icon" href="/favicon.ico">
    
  
<link rel="stylesheet" href="/css/style.css">

  
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <main class="content" >
    <section class="outer" style="min-height: 90vh;">
  <article  id="post-Gin_note" class="article article-type-post" itemscope
            itemprop="blogPost" data-scroll-reveal>

            <div class="article-inner" 
              <header class="article-header">
                
  
  <h1 class="article-title" itemprop="name">
    Gin ç¬”è®°
  </h1>
  
  

              </header>
              

                
                  <div class="article-meta">
                    <a href="/2024/04/01/Gin_note/" class="article-date">
  <time datetime="2024-04-01T06:11:40.000Z" itemprop="datePublished">2024-04-01</time>
</a>
                      
<div class="article-category">
  <a class="article-category-link" href="/categories/%E5%90%8E%E7%AB%AF/">åç«¯</a>
</div>

                  </div>
                  

                    
                      
<div class="tocbot" style="font-size: medium;"></div>

                        

                          <div class="article-entry" itemprop="articleBody">
                            


                              

                                <!--  -->
                                
                                          <p>â€‹	Gin æ˜¯ Golang å¸¸ç”¨çš„ä¸€ç§è½»é‡å‹æ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²ä¸”å¯ä»¥è‡ªå®šä¹‰é¡¹ç›®ç»“æ„ï¼Œå¯å¡‘æ€§å’Œæ“ä½œæ€§å¾ˆå¼ºï¼Œæ­é…å„ç§åº“å¯ä»¥å®ç°éå¸¸ä¸é”™çš„æ•ˆæœï¼Œç²¾ç®€çš„åŒæ—¶æ€§èƒ½ä¹Ÿä¸æ¯«ä¸è½ä¸‹é£ï¼Œå¯ä»¥è¯´æ˜¯å…¼é¡¾äº†æ€§èƒ½å’Œè½»ä¾¿ç¨‹åº¦ï¼Œå­¦ä¹ å’Œå¼€å‘éš¾åº¦è¾ƒä½äº Springboot é‚£ç§èˆªç©ºæ¯èˆ°å‹æ¡†æ¶ï¼Œä½†æ˜¯æƒ³è¦ä½¿ç”¨çš„å¾—å¿ƒåº”æ‰‹è¿˜éœ€è¦å¯¹åç«¯å’Œ Golang åŸç”Ÿæœ‰ä¸€å®šçš„ç†Ÿæ‚‰ç¨‹åº¦ã€‚</p>
<span id="more"></span>

<blockquote>
<ul>
<li>Created by Typora</li>
<li>Author: LRay-iu</li>
<li>createTime: 2024-03-28 13:36</li>
<li>updateTime: 2024-04-01 10:43</li>
</ul>
</blockquote>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¹Ÿä¸çŸ¥é“æ˜¯æˆ‘å¼€çš„ç¬¬å‡ ä»½ç¬”è®°äº†ï¼Œä¸»æ‰“çš„æ˜¯è®°å½• Gin åç«¯çš„<strong>æ­å»º</strong>ï¼Œå†…å®¹åº”è¯¥ä¸ä¼šå¾ˆå¤šï¼Œæ¯•ç«Ÿ Gin å’Œ Flask ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªè½»é‡å‹çš„æ¡†æ¶ï¼Œä¸»æ‰“çš„æ˜¯å¿«é€Ÿå¼€å‘ï¼Œä½†æ˜¯ Gin çš„å“åº”é€Ÿåº¦ä¸Šæ¯” Flask å¿«çš„ä¸æ˜¯ä¸€ç‚¹ç‚¹ï¼Œè¯­è¨€åŸç”Ÿæ”¯æŒä¸Š Golang ä¸éœ€è¦é¢å¤–çš„åº“ä¹Ÿèƒ½å®Œæˆåç¨‹ï¼Œç®¡é“ï¼Œæ˜ å°„ç­‰ç­‰åŠŸèƒ½ã€‚ä½†æ˜¯å’Œ Goframeã€SpringBoot é‚£äº›èˆªç©ºæ¯èˆ°çº§çš„æ¡†æ¶ä¸å¤ªä¸€æ ·ï¼ŒGin æœ¬èº«åƒä¸ªå…‰æ†å¸ä»¤ï¼Œæœ‰ä¸å°‘åŠŸèƒ½æ˜¯éœ€è¦å¼•å…¥å…¶ä»–æ¨¡å—æ¥å®ç°çš„ï¼Œæ¯”å¦‚ Gormï¼Œgodotenv ç­‰ç­‰ï¼›</p>
<p>è‡³äº Goframeï¼ŒåŸå…ˆç¡®å®èŒç”Ÿè¿‡å¥½å¥½å­¦ä¹ å®ƒçš„æƒ³æ³•ï¼Œä¸è¿‡ç°åœ¨æƒ…å†µç‰¹æ®Šï¼Œä¸€æ¥æ˜¯åŸå…ˆæŠ•çš„å²—ä½è²Œä¼¼è«å¾—äº†ï¼ŒäºŒæ¥æ˜¯æ¯•è®¾è€å¸ˆå‚¬æŒºæ€¥çš„ï¼Œæ²¡æ—¶é—´å¼€æ–°å‘äº†ï¼ŒæŠ“ç´§å†™å®ŒæŠ“ç´§ Gapã€‚</p>
<h2 id="å·¥å…·åŒ…"><a href="#å·¥å…·åŒ…" class="headerlink" title="å·¥å…·åŒ…"></a>å·¥å…·åŒ…</h2><p>Gin å¿«é€Ÿæ­å»ºæ•™ç¨‹[æ¥è‡ª B ç«™â€™æ…•è¯¾ç½‘â€™]ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Jy4y1F7RG/">https://www.bilibili.com/video/BV1Jy4y1F7RG/</a></p>
<p>Gin ä¸­æ–‡å¼€å‘æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://gin-gonic.com/zh-cn/docs/quickstart/">å¿«é€Ÿå…¥é—¨ | Gin Web Framework (gin-gonic.com)</a></p>
<p>Gorm ä¸­æ–‡å¼€å‘æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/">GORM æŒ‡å— | GORM - The fantastic ORM library for Golang, aims to be developer friendly.</a></p>
<h2 id="å¼€å‘æŠ¥é”™"><a href="#å¼€å‘æŠ¥é”™" class="headerlink" title="å¼€å‘æŠ¥é”™"></a>å¼€å‘æŠ¥é”™</h2><blockquote>
<ul>
<li><p>å¦‚æœå¼€å‘è¿‡ç¨‹ä¸­å‡ºç°<code>404-not-found</code>ï¼Œè¯·å…ˆæ£€æŸ¥è¯·æ±‚æ¨¡å¼æ˜¯<code>GET</code>è¿˜æ˜¯<code>POST</code></p>
</li>
<li><p>å¦‚æœ gorm æŸ¥è¯¢ç»“æœä¸ºç©ºä¸”æ•°æ®åº“æŸ¥è¯¢æ­£å¸¸ï¼Œè¯·æ£€æŸ¥ gorm æ ‡ç­¾æ˜¯å¦æ­£ç¡®<code>gorm:&quot;column:publicKey&quot;</code></p>
</li>
<li><p>å¦‚æœå¼€å‘è¿‡ç¨‹ä¸­ï¼Œåœ¨æ•°æ®åº“<code>Mysql</code>ä¸­è®¾ç½®äº†é»˜è®¤å€¼ï¼Œä½†æ˜¯ä¸ä¼šå¯ç”¨ï¼Œå¯èƒ½æ˜¯ gorm ç»™è¦†ç›–äº†ï¼Œéœ€è¦åœ¨<code>gorm</code>è¿™é‡æ–°å®šä¹‰</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">Isvisual       <span class="type">int</span>     <span class="string">`gorm:&quot;column:isvisual;default:1&quot;`</span></span><br><span class="line">Status         <span class="type">int</span>     <span class="string">`gorm:&quot;column:status;default:1&quot;`</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœ json ç»‘å®šå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç»“æ„ä½“å®šä¹‰çš„å˜é‡å¤´æ˜¯å¦å°å†™ï¼ˆè¢«å®šä¹‰æˆç§æœ‰å˜é‡äº†ï¼‰</p>
</li>
<li><p><code>sqlx</code> åœ¨æŠŠ<code>timestamp</code>è½¬ä¸º<code>go</code>çš„<code>time.Time</code>æŠ¥é”™<code>Scan error on column index 6: unsupported Scan, storing driver.Value type []uint8 into type *time.Time</code>,éœ€è¦åœ¨æ•°æ®åº“é…ç½®æ—¶åŠ ä¸Š<code>parseTime=true</code>ï¼Œå³:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">Mysqldb = fmt.Sprintf(<span class="string">&quot;%s:%s@tcp(127.0.0.1:3306)/minato_sys?charset=utf8mb4&amp;parseTime=true&quot;</span>, name, password)</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡ï¼Œè¿™ä¸€ç‚¹æˆ‘å·²ç»åœ¨æ•°æ®åº“é…ç½®é‚£ä¸€ç¯ä¿®æ”¹è¿‡äº†ï¼ŒæŒ‰ç€ç¬”è®°èµ°åº”è¯¥ç¢°ä¸åˆ°è¿™ä¸ªé”™è¯¯ã€‚</p>
</li>
<li></li>
</ul>
</blockquote>
<h2 id="Gin-åˆ›å»ºå·¥ç¨‹"><a href="#Gin-åˆ›å»ºå·¥ç¨‹" class="headerlink" title="Gin åˆ›å»ºå·¥ç¨‹"></a>Gin åˆ›å»ºå·¥ç¨‹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆå§‹åŒ–é¡¹ç›®</span><br><span class="line">$ go mod init gin-Minato</span><br><span class="line"></span><br><span class="line"># å®‰è£…Ginæ¡†æ¶</span><br><span class="line">$ go get github.com/gin-gonic/gin@latest</span><br><span class="line"></span><br><span class="line"># å®‰è£…çƒ­åŠ è½½æ’ä»¶fresh</span><br><span class="line">$ go install github.com/pilu/fresh@latest</span><br><span class="line">$ go get github.com/pilu/fresh</span><br><span class="line">$ fresh</span><br><span class="line"></span><br><span class="line"># å®‰è£…godotenvæ’ä»¶</span><br><span class="line">$ go get github.com/joho/godotenv</span><br><span class="line"></span><br><span class="line"># å®‰è£…Gorm</span><br><span class="line">$ go get -u gorm.io/gorm</span><br><span class="line">$ go get -u gorm.io/driver/mysql  #ä½ ç”¨ä»€ä¹ˆå°±ä¸‹ä»€ä¹ˆï¼Œè¿™è¾¹ä»¥mysqlä¸ºä¾‹</span><br><span class="line"></span><br><span class="line"># å®‰è£…sessionå’Œredis</span><br><span class="line">$ go get github.com/gin-contrib/sessions</span><br><span class="line">$ go get github.com/gin-contrib/sessions/redis</span><br><span class="line"></span><br><span class="line"># å®‰è£…JWT-go</span><br><span class="line">$ go get github.com/dgrijalva/jwt-go</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.String(http.StatusOK, <span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">//r.Run(&quot;:8080&quot;)</span></span><br><span class="line">	r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¯åŠ¨</span><br><span class="line">$ go run main.go</span><br><span class="line"># å¦‚æœå®‰è£…è¿‡freshï¼Œåˆ™å¯ä»¥</span><br><span class="line">$ fresh</span><br></pre></td></tr></table></figure>

<h2 id="è·¯ç”±åˆ†é…"><a href="#è·¯ç”±åˆ†é…" class="headerlink" title="è·¯ç”±åˆ†é…"></a>è·¯ç”±åˆ†é…</h2><p>æ­¥éª¤ï¼šåœ¨<code>router.go</code>ä¸­åˆ›å»º<code>ginå¼•æ“</code>ï¼Œåœ¨<code>main.go</code>é‡Œè°ƒç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//routers.go</span></span><br><span class="line"><span class="keyword">package</span> router</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Router</span><span class="params">()</span></span> *gin.Engine &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	user := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		user.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">			ctx.String(http.StatusOK, <span class="string">&quot;hello world1!&quot;</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">		user.PUT(<span class="string">&quot;/add&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">			ctx.String(http.StatusOK, <span class="string">&quot;hello world2!&quot;</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">		user.POST(<span class="string">&quot;/post&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">			ctx.String(http.StatusOK, <span class="string">&quot;hello world3!&quot;</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">		user.DELETE(<span class="string">&quot;/delete&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">			ctx.String(http.StatusOK, <span class="string">&quot;hello world4!&quot;</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨<code>main.go</code>ä¸­è°ƒç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;gin-Minato/router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := router.Router()</span><br><span class="line">	<span class="comment">//r.Run(&quot;:8080&quot;)</span></span><br><span class="line">	r.Run()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>OK å®Œæˆï¼Œç»ˆäºä¸ç”¨å…¨å†™åœ¨ main æ–‡ä»¶é‡Œäº†ï¼Œä¸è¿‡è¿™ä¸ªå†™æ³•è¿˜æ˜¯ä¸å¤Ÿç®€æ´ï¼Œå¹¶ä¸ç¬¦åˆå®˜æ–¹æ–‡æ¡£</p>
<h2 id="å°†å¤„ç†æ–¹æ³•å¤–ç½®åˆ°å…¶ä»–åŒ…è£¹"><a href="#å°†å¤„ç†æ–¹æ³•å¤–ç½®åˆ°å…¶ä»–åŒ…è£¹" class="headerlink" title="å°†å¤„ç†æ–¹æ³•å¤–ç½®åˆ°å…¶ä»–åŒ…è£¹"></a>å°†å¤„ç†æ–¹æ³•å¤–ç½®åˆ°å…¶ä»–åŒ…è£¹</h2><p>è¿™æ˜¯æˆ‘ä¸ªäººå¯¹å®ƒçš„å«æ³•ï¼Œå°±æ˜¯æä¸€å˜´ï¼Œæ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œä½†æ˜¯èƒ½å¤Ÿè®©é¡¹ç›®æ›´åŠ ç®€æ´æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤ã€‚</p>
<p>å®šä¹‰æ§åˆ¶å™¨ä¸­å¸¸ç”¨çš„æ–¹æ³•å’Œæ•°æ®ç»“æ„</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//controller/commen.go</span></span><br><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JsonStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">	Code  <span class="type">int</span>         <span class="string">`json:&quot;code&quot;`</span>  <span class="comment">//è¿”å›çŠ¶æ€ç </span></span><br><span class="line">	Msg   <span class="keyword">interface</span>&#123;&#125; <span class="string">`json:&quot;msg&quot;`</span>   <span class="comment">//è¿”å›çš„æç¤ºè¯­</span></span><br><span class="line">	Data  <span class="keyword">interface</span>&#123;&#125; <span class="string">`json:&quot;data&quot;`</span>  <span class="comment">//è¿”å›æ•°æ®</span></span><br><span class="line">	Count <span class="keyword">interface</span>&#123;&#125; <span class="string">`json:&quot;count&quot;`</span> <span class="comment">//è¿”å›æ¡æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JsonErrStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">	Code <span class="type">int</span>         <span class="string">`json:&quot;code&quot;`</span> <span class="comment">//è¿”å›çŠ¶æ€ç </span></span><br><span class="line">	Msg  <span class="keyword">interface</span>&#123;&#125; <span class="string">`json:&quot;msg&quot;`</span>  <span class="comment">//è¿”å›çš„æç¤ºè¯­</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReturnSuccess</span><span class="params">(c *gin.Context, code <span class="type">int</span>, msg <span class="keyword">interface</span>&#123;&#125;, data <span class="keyword">interface</span>&#123;&#125;, count <span class="type">int64</span>)</span></span> &#123;</span><br><span class="line">	json := &amp;JsonStruct&#123;Code: code, Msg: msg, Data: data, Count: count&#125;</span><br><span class="line">	c.JSON(<span class="number">200</span>, json)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReturnFalse</span><span class="params">(c *gin.Context, code <span class="type">int</span>, msg <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	json := &amp;JsonErrStruct&#123;Code: code, Msg: msg&#125;</span><br><span class="line">	c.JSON(<span class="number">200</span>, json)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è§’è‰²æ§åˆ¶å™¨ä¸­ä½¿ç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//controller/user.go</span></span><br><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserController <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†å…¶å½’è¿›ç»“æ„ä½“ä¸­ï¼Œé¿å…ä¸åŒä¸€ä¸ªåŒ…ä¸‹çš„å…¶ä»–æ–¹æ³•åå­—å†²çªã€‚å°±æ˜¯å¼•ç”¨çš„æ—¶å€™ç¨å¾®éº»çƒ¦äº›</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserController)</span></span> GetUserInfo(c *gin.Context) &#123;</span><br><span class="line">	ReturnSuccess(c, <span class="number">0</span>, <span class="string">&quot;success&quot;</span>, <span class="string">&quot;user info&quot;</span>, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>main.go</code>ä¸­å¼•ç”¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//main.go</span></span><br><span class="line">user.GET(<span class="string">&quot;/info&quot;</span>, controller.UserController&#123;&#125;.GetUserInfo)</span><br><span class="line">user.GET(<span class="string">&quot;/err&quot;</span>, controller.UserController&#123;&#125;.GetUserList)</span><br></pre></td></tr></table></figure>

<p>ok å®Œæˆï¼Œå·²ç»æœ‰ä¸€ä¸ªé¡¹ç›®çš„é›å½¢äº†</p>
<h2 id="ä»ä¸Šä¸‹æ–‡è·å–æ•°æ®"><a href="#ä»ä¸Šä¸‹æ–‡è·å–æ•°æ®" class="headerlink" title="ä»ä¸Šä¸‹æ–‡è·å–æ•°æ®"></a>ä»ä¸Šä¸‹æ–‡è·å–æ•°æ®</h2><p><code>*c gin.context</code>æ˜¾ç„¶ä¸æ˜¯åƒå¹²é¥­çš„ï¼Œæ¯å›å†™æ–¹æ³•éƒ½æŠŠå®ƒå¸¦ä¸Šæ˜¯æœ‰åŸå› çš„</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(U UserController)</span></span> GetUserList(c *gin.Context) &#123;</span><br><span class="line">	cid := c.PostForm(<span class="string">&quot;cid&quot;</span>)</span><br><span class="line">	name := c.DefaultPostForm(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;æå¤§å£®&quot;</span>)<span class="comment">//æä¾›é»˜è®¤å€¼</span></span><br><span class="line">	ReturnSuccess(c, <span class="number">0</span>, cid, name, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¥å—æ•°æ®çš„æ–¹æ³•</p>
<p>è¿™é‡Œä½¿ç”¨ Apifoxï¼ˆå…è´¹çš„ï¼Œå¥½ä½¿ ğŸ‘ï¼‰å‘å®ƒå‘é€è¯·æ±‚</p>
<img src="/2024/04/01/Gin_note/image-20240329131341634.png" alt="image-20240329131341634" style="zoom: 67%;">

<p>ok å®Œæˆï¼Œæ•ˆæœæ˜¾è‘—</p>
<h2 id="å°†è¯·æ±‚è·å–çš„æ•°æ®ç»‘å®šåˆ°ç»“æ„ä½“"><a href="#å°†è¯·æ±‚è·å–çš„æ•°æ®ç»‘å®šåˆ°ç»“æ„ä½“" class="headerlink" title="å°†è¯·æ±‚è·å–çš„æ•°æ®ç»‘å®šåˆ°ç»“æ„ä½“"></a>å°†è¯·æ±‚è·å–çš„æ•°æ®ç»‘å®šåˆ°ç»“æ„ä½“</h2><p>ä¸Šè¿°æ–¹æ³•ä¸é€‚åˆè¯»å– json æ•°æ®æŠ¥æ–‡</p>
<p>ç¬¬ä¸€ç§,ä»¥èµ‹å€¼çš„å½¢å¼è¯»è¿‡æ¥</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(U UserController)</span></span> GetUserList(c *gin.Context) &#123;</span><br><span class="line">	<span class="comment">//cid := c.PostForm(&quot;cid&quot;)</span></span><br><span class="line">	<span class="comment">//name := c.DefaultPostForm(&quot;name&quot;, &quot;æå¤§å£®&quot;) //æä¾›é»˜è®¤å€¼</span></span><br><span class="line">	param := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	err := c.BindJSON(&amp;param)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		ReturnSuccess(c, <span class="number">0</span>, <span class="string">&quot;success&quot;</span>,param, <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		ReturnFalse(c, <span class="number">4001</span>, gin.H&#123;<span class="string">&quot;err&quot;</span>: err&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§ï¼Œç»‘å®šåˆ°ç»“æ„ä½“</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Search <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="type">string</span> <span class="string">`json:name`</span>   <span class="comment">//å¿…é¡»è¦jsonåŒ¹é…ä¸Šï¼Œå¦åˆ™å¯èƒ½è¯»ä¸åˆ°</span></span><br><span class="line">	Cid  <span class="type">int</span>    <span class="string">`json:cid`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(U UserController)</span></span> GetUserList(c *gin.Context) &#123;</span><br><span class="line">	search := &amp;Search&#123;&#125;</span><br><span class="line">	err := c.BindJSON(&amp;search)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		ReturnSuccess(c, <span class="number">0</span>, search.Name, search.Cid, <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		ReturnFalse(c, <span class="number">4001</span>, gin.H&#123;<span class="string">&quot;err&quot;</span>: err&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="defer-å»¶è¿Ÿæ•è·å¼‚å¸¸"><a href="#defer-å»¶è¿Ÿæ•è·å¼‚å¸¸" class="headerlink" title="defer å»¶è¿Ÿæ•è·å¼‚å¸¸"></a>defer å»¶è¿Ÿæ•è·å¼‚å¸¸</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;æ•è·å¼‚å¸¸&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

<p>è‡ªåŠ¨è¿è¡Œï¼Œå¡åœ¨æ–¹æ³•é‡Œé¢å°±è¡Œï¼Œä½†æ˜¯å‰ç«¯å¾—ä¸åˆ°æŠ¥é”™æƒ…å†µã€‚</p>
<h2 id="Gorm"><a href="#Gorm" class="headerlink" title="Gorm"></a>Gorm</h2><p>è¿™æ˜¯ä¸€ä¸ª SQL æ˜ å°„åº“</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>åˆ›å»ºæ–‡ä»¶<code>config/dbconnect.go</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åˆå§‹åŒ–æ•°æ®åº“é“¾æ¥</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">package</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	_ <span class="string">&quot;github.com/joho/godotenv/autoload&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/driver/mysql&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	Db      *gorm.DB</span><br><span class="line">	err     <span class="type">error</span></span><br><span class="line">	Mysqldb <span class="type">string</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//åˆå§‹åŒ–æ•°æ®åº“çš„é’¥åŒ™</span></span><br><span class="line">	name := os.Getenv(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">	password := os.Getenv(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> name == <span class="string">&quot;&quot;</span> || password == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;ç¼ºå°‘å¿…è¦çš„ç¯å¢ƒå˜é‡ name æˆ– password&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	Mysqldb = fmt.Sprintf(<span class="string">&quot;%s:%s@tcp(127.0.0.1:3306)/minato_sys?charset=utf8mb4&amp;parseTime=true&quot;</span>, name, password)</span><br><span class="line">	<span class="comment">//é“¾æ¥æ•°æ®åº“</span></span><br><span class="line">	Db, err = gorm.Open(mysql.Open(Mysqldb), &amp;gorm.Config&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;mysql connect error:&quot;</span>, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> Db.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;mysql connect error:&quot;</span>, Db.Error)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//è®¾ç½®è¿æ¥æ± </span></span><br><span class="line">	sqlDB, _ := Db.DB()</span><br><span class="line">	<span class="comment">// SetMaxIdleConns sets the maximum number of connections in the idle connection pool.</span></span><br><span class="line">	sqlDB.SetMaxIdleConns(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// SetMaxOpenConns sets the maximum number of open connections to the database.</span></span><br><span class="line">	sqlDB.SetMaxOpenConns(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// SetConnMaxLifetime sets the maximum amount of time a connection may be reused.</span></span><br><span class="line">	sqlDB.SetConnMaxLifetime(time.Hour)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åç»­å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦ï¼Œåˆ†åˆ«å†™åœ¨è‡ªå·±æƒ³è¦çš„æ–‡ä»¶é‡Œ</p>
<p>æ³¨ï¼šæ­¤å¤„ç”¨åˆ°äº† godotenv æ’ä»¶ï¼Œå¯ä»¥ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–æ•°æ®ï¼Œä½¿ç”¨æ—¶å¯ä»¥å‚è€ƒè¿™ä½è€å“¥å†™çš„ï¼š<a target="_blank" rel="noopener" href="https://darjun.github.io/2020/02/12/godailylib/godotenv/">Go æ¯æ—¥ä¸€åº“ä¹‹ godotenv - å¤§ä¿Šçš„åšå®¢ (darjun.github.io)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹çš„envæ–‡ä»¶</span><br><span class="line">name = root</span><br><span class="line">password = 88888888</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•æ•°æ®åº“æ˜¯å¦é“¾æ¥"><a href="#æµ‹è¯•æ•°æ®åº“æ˜¯å¦é“¾æ¥" class="headerlink" title="æµ‹è¯•æ•°æ®åº“æ˜¯å¦é“¾æ¥"></a>æµ‹è¯•æ•°æ®åº“æ˜¯å¦é“¾æ¥</h3><p>æ³¨ï¼šä»¥ä¸‹ä»£ç ä»…æ˜¯æµ‹è¯•ä½¿ç”¨ï¼Œä¸å¯ç›´æ¥ç²˜è´´ã€ç›´æ¥ç²˜è´´å’Œä¼ªä»£ç æ²¡å•¥åŒºåˆ«ã€‘ï¼Œæ ¹æ®éœ€æ±‚è¿›è¡Œæ”¹åŠ¨</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰è·¯ç”±</span></span><br><span class="line">user.GET(<span class="string">&quot;/info/:cid&quot;</span>, controller.UserController&#123;&#125;.GetUserInfo)</span><br><span class="line"><span class="comment">//æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserController)</span></span> GetUserInfo(c *gin.Context) &#123;</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;æ•è·å¼‚å¸¸&quot;</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	cid := c.Param(<span class="string">&quot;cid&quot;</span>)</span><br><span class="line">	id, err := strconv.Atoi(cid)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	user, _ := model.GetUserTest(id)</span><br><span class="line">	ReturnSuccess(c, <span class="number">0</span>, <span class="string">&quot;success&quot;</span>, user, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰æ•°æ®åº“æ¨¡å‹</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id   <span class="type">int</span></span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> DB = config.Db</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(User)</span></span> TableName() <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetUserTest</span><span class="params">(id <span class="type">int</span>)</span></span> (User, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	err := DB.Where(<span class="string">&quot;id=?&quot;</span>, id).First(&amp;user).Error</span><br><span class="line">	<span class="keyword">return</span> user, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸”æµ‹è¯•å‰ï¼Œæ•°æ®åº“éœ€è¦å»ºç«‹å¥½æµ‹è¯•è¡¨</p>
<img src="/2024/04/01/Gin_note/image-20240330175545744.png" alt="image-20240330175545744" style="zoom: 80%;">

<p>æœ€ç»ˆç»“æœï¼š</p>
<img src="/2024/04/01/Gin_note/image-20240330175639344.png" alt="image-20240330175639344" style="zoom: 80%;">

<p>ok å®Œæˆï¼Œè¿™ä¸‹é¡¹ç›®åŸºæœ¬ç»“æ„å°±æ­å»ºå¥½äº†</p>
<h3 id="åŸºç¡€-crud"><a href="#åŸºç¡€-crud" class="headerlink" title="åŸºç¡€ crud"></a>åŸºç¡€ crud</h3><p>è¿™ä¸ªè®²é“ç†æ²¡å•¥å¥½è¯´çš„ï¼Œå®˜æ–¹æ–‡æ¡£å†™çš„è›®æ¸…æ™°çš„</p>
<p>è´´ç‚¹æ ·ä¾‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetUserTest</span><span class="params">(id <span class="type">int</span>)</span></span> (User, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	err := DB.Where(<span class="string">&quot;id=?&quot;</span>, id).First(&amp;user).Error</span><br><span class="line">	<span class="keyword">return</span> user, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddUser</span><span class="params">(id <span class="type">int</span>, name <span class="type">string</span>)</span></span> (<span class="type">int</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	user := User&#123;Id: id, Name: name&#125;</span><br><span class="line">	err := DB.Create(&amp;user).Error</span><br><span class="line">	<span class="keyword">return</span> user.Id, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">EditUser</span><span class="params">(id <span class="type">int</span>, name <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	user := User&#123;</span><br><span class="line">		Id:   id,</span><br><span class="line">		Name: name,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ä¼ å¯¹è±¡ä¿®æ”¹</span></span><br><span class="line">    DB.Model(&amp;User&#123;&#125;).Updates(&amp;user)</span><br><span class="line">	<span class="comment">//ä¿®æ”¹å•ç‹¬çš„åˆ—</span></span><br><span class="line">	<span class="comment">//DB.Model(&amp;User&#123;&#125;).Where(&quot;id=?&quot;, id).Update(&quot;name&quot;, name)</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Delete</span><span class="params">(id <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	DB.Delete(&amp;User&#123;&#125;, <span class="number">10</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ç™»å½•åŠŸèƒ½ï¼ˆé™„å¸¦ä½¿ç”¨-redis-å­˜å–-sessionï¼‰"><a href="#ç™»å½•åŠŸèƒ½ï¼ˆé™„å¸¦ä½¿ç”¨-redis-å­˜å–-sessionï¼‰" class="headerlink" title="ç™»å½•åŠŸèƒ½ï¼ˆé™„å¸¦ä½¿ç”¨ redis å­˜å– sessionï¼‰"></a>ç™»å½•åŠŸèƒ½ï¼ˆé™„å¸¦ä½¿ç”¨ redis å­˜å– sessionï¼‰</h3><p><code>Redis</code>éƒ¨ç½²è¿›é¡¹ç›®</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> router</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;gin-Minato/config&quot;</span></span><br><span class="line">	<span class="string">&quot;gin-Minato/controller&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line">	session_redis <span class="string">&quot;github.com/gin-contrib/sessions/redis&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Router</span><span class="params">()</span></span> *gin.Engine &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">//é…ç½®redis</span></span><br><span class="line">	store, _ := session_redis.NewStore(<span class="number">10</span>, <span class="string">&quot;tcp&quot;</span>, config.RedisAddress, <span class="string">&quot;&quot;</span>, []<span class="type">byte</span>(<span class="string">&quot;secret&quot;</span>))</span><br><span class="line">	r.Use(sessions.Sessions(<span class="string">&quot;mysession&quot;</span>, store))</span><br><span class="line">	user := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		user.POST(<span class="string">&quot;/login&quot;</span>, controller.UserController&#123;&#125;.Login)</span><br><span class="line">		user.POST(<span class="string">&quot;/register&quot;</span>, controller.UserController&#123;&#125;.Register)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>redis.go</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	RedisAddress = <span class="string">&quot;localhost:6379&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>controller/user.go</code></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserController)</span></span> Login(c *gin.Context) &#123;</span><br><span class="line">	username := c.DefaultPostForm(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">	password := c.DefaultPostForm(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> username == <span class="string">&quot;&quot;</span> || password == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		ReturnFalse(c, <span class="number">4001</span>, <span class="string">&quot;è¯·è¾“å…¥è´¦å·å’Œå¯†ç &quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	user, err := model.GetUserInfoByUsername(username)</span><br><span class="line">	<span class="keyword">if</span> user.Id == <span class="number">0</span> &#123;</span><br><span class="line">		ReturnFalse(c, <span class="number">4002</span>, <span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> user.Password != EncryMd5(password) &#123;</span><br><span class="line">		ReturnFalse(c, <span class="number">4002</span>, <span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	session := sessions.Default(c)</span><br><span class="line">	session.set(<span class="string">&quot;login&quot;</span>+strconv.Itoa(user.Id), user.Id)</span><br><span class="line">	session.Save()</span><br><span class="line">	data := UserApi&#123;Id: user.id, Username: user.Username&#125;</span><br><span class="line">	ReturnSuccess(c, <span class="number">0</span>, <span class="string">&quot;ç™»é™†æˆåŠŸ&quot;</span>, data, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JWT-go"><a href="#JWT-go" class="headerlink" title="JWT-go"></a>JWT-go</h2><p>å¯ä»¥é™åˆ¶ä»¤ç‰ŒæŒæœ‰è€…èƒ½è®¿é—®çš„èµ„æº</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/dgrijalva/jwt-go&quot;</span></span><br><span class="line">	_ <span class="string">&quot;github.com/joho/godotenv/autoload&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼„ä¸ªç®€å•ä¸€ç‚¹çš„token</span></span><br><span class="line"><span class="keyword">type</span> Konoha <span class="keyword">struct</span> &#123;</span><br><span class="line">	Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">	jwt.StandardClaims</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»envæ–‡ä»¶ä¸­è¯»å–å¯†é’¥</span></span><br><span class="line"><span class="keyword">var</span> salt = os.Getenv(<span class="string">&quot;salt&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> mySignkey = []<span class="type">byte</span>(salt)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Tokencreate</span><span class="params">(username <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	c := Konoha&#123;</span><br><span class="line">		Username: username,</span><br><span class="line">		StandardClaims: jwt.StandardClaims&#123;</span><br><span class="line">			NotBefore: time.Now().Unix() - <span class="number">60</span>,</span><br><span class="line">			<span class="comment">//è®¾ç½®è¿‡æœŸæ—¶é—´åœ¨5ç§’å</span></span><br><span class="line">			ExpiresAt: time.Now().Unix() + <span class="number">5</span>,</span><br><span class="line">			Issuer:    <span class="string">&quot;Minato&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	token := jwt.NewWithClaims(jwt.SigningMethodHS256, c)</span><br><span class="line">	tokenString, err := token.SignedString(mySignkey)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;tokenåŠ å¯†å‡ºé”™&quot;</span>, err.Error)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(tokenString)</span><br><span class="line">	<span class="keyword">return</span> tokenString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ParseToken</span><span class="params">(tokenString <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	token, err := jwt.ParseWithClaims(tokenString, &amp;Konoha&#123;&#125;, <span class="function"><span class="keyword">func</span><span class="params">(token *jwt.Token)</span></span> (<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> mySignkey, <span class="literal">nil</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err.Error())</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(token.Claims.(*Konoha))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//åˆ¶ä½œtoken</span></span><br><span class="line">	s := Tokencreate(<span class="string">&quot;minato&quot;</span>)</span><br><span class="line">    <span class="comment">//ç­‰tokenè¿‡æœŸ</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;ç­‰å…­ç§’&quot;</span>)</span><br><span class="line">	time.Sleep(<span class="number">6</span> * time.Second)</span><br><span class="line">	ParseToken(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1pbmF0byIsImV4cCI6MTcxMjAzNDY5NywiaXNzIjoiTWluYXRvIiwibmJmIjoxNzEyMDM0NjMyfQ.rUsDMCOgP4-Tvq09UO0YWXVcfaetFtqhWejSszb2DCc</span><br><span class="line">ç­‰å…­ç§’</span><br><span class="line">token is expired by 1s</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°†å®ƒå†™æˆä¸­é—´ä»¶çš„å½¢å¼ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> middleware</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;gin-Minato/controller&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/dgrijalva/jwt-go&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	_ <span class="string">&quot;github.com/joho/godotenv/autoload&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼„ä¸ªç®€å•ä¸€ç‚¹çš„token</span></span><br><span class="line"><span class="keyword">type</span> Konoha <span class="keyword">struct</span> &#123;</span><br><span class="line">	Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">	jwt.StandardClaims</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»envæ–‡ä»¶ä¸­è¯»å–å¯†é’¥</span></span><br><span class="line"><span class="keyword">var</span> salt = os.Getenv(<span class="string">&quot;salt&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> mySignkey = []<span class="type">byte</span>(salt)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Tokencreate</span><span class="params">(username <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	c := Konoha&#123;</span><br><span class="line">		Username: username,</span><br><span class="line">		StandardClaims: jwt.StandardClaims&#123;</span><br><span class="line">			NotBefore: time.Now().Unix() - <span class="number">60</span>,</span><br><span class="line">			<span class="comment">//è®¾ç½®è¿‡æœŸæ—¶é—´åœ¨60ç§’å</span></span><br><span class="line">			ExpiresAt: time.Now().Unix() + <span class="number">60</span>,</span><br><span class="line">			Issuer:    <span class="string">&quot;Minato&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	token := jwt.NewWithClaims(jwt.SigningMethodHS256, c)</span><br><span class="line">	konohaToken, err := token.SignedString(mySignkey)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;tokenåŠ å¯†å‡ºé”™&quot;</span>, err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(konohaToken)</span><br><span class="line">	<span class="keyword">return</span> konohaToken</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//-----------------------------------------åœ¨è¿™å‘¢ï¼Œä¸­é—´ä»¶è§£ætoken------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ParseToken</span><span class="params">(konohaToken <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	token, err := jwt.ParseWithClaims(konohaToken, &amp;Konoha&#123;&#125;, <span class="function"><span class="keyword">func</span><span class="params">(token *jwt.Token)</span></span> (<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> mySignkey, <span class="literal">nil</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err.Error())</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;1001&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> !token.Valid &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;tokenæ— æ•ˆ&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;1002&quot;</span> <span class="comment">// è¿”å›æ— æ•ˆtokençš„é”™è¯¯ç </span></span><br><span class="line">	&#125;</span><br><span class="line">	claims, ok := token.Claims.(*Konoha)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;token claimsç±»å‹é”™è¯¯&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;1003&quot;</span> <span class="comment">// è¿”å›token claimsç±»å‹é”™è¯¯çš„é”™è¯¯ç </span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> claims.Username != <span class="string">&quot;Minato&quot;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;1004&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;200&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">JWTAuth</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		tokenStr := c.Request.Header.Get(<span class="string">&quot;konohaToken&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> tokenStr == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1000</span>, <span class="string">&quot;tokenç¼ºå¤±&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		status := ParseToken(tokenStr)</span><br><span class="line">		<span class="keyword">switch</span> status &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;1000&quot;</span>:</span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1001</span>, <span class="string">&quot;tokenè¿‡æœŸ&quot;</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;1001&quot;</span>:</span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1002</span>, <span class="string">&quot;tokenç­¾å‘äººä¸æ­£ç¡®&quot;</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;1002&quot;</span>:</span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1003</span>, <span class="string">&quot;token claimsç±»å‹é”™è¯¯&quot;</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;1003&quot;</span>:</span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1004</span>, <span class="string">&quot;tokenæ— æ•ˆ&quot;</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;200&quot;</span>:</span><br><span class="line">			<span class="comment">// tokenéªŒè¯é€šè¿‡</span></span><br><span class="line">			fmt.Println(<span class="number">200</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="comment">// å¤„ç†å…¶ä»–æœªçŸ¥é”™è¯¯</span></span><br><span class="line">			controller.ReturnFalse(c, <span class="number">1999</span>, <span class="string">&quot;æœªçŸ¥é”™è¯¯&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="è·¨åŸŸè¯·æ±‚-CORS"><a href="#è·¨åŸŸè¯·æ±‚-CORS" class="headerlink" title="è·¨åŸŸè¯·æ±‚ CORS"></a>è·¨åŸŸè¯·æ±‚ CORS</h2><p>å®‰è£… CORS</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ go get github.com/gin-contrib/cors</span><br></pre></td></tr></table></figure>

<p><code>main.go</code>ä¸­è¿›è¡Œé…ç½®</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/cors&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½¿ç”¨ CORS ä¸­é—´ä»¶ï¼Œé»˜è®¤é…ç½®ï¼Œè°éƒ½èƒ½è®¿é—®</span></span><br><span class="line">	r.Use(cors.Default())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨CORSä¸­é—´ä»¶ï¼Œå¹¶åªå…è®¸æ¥è‡ª5173ç«¯å£çš„è¯·æ±‚ï¼ˆå’Œä¸Šé¢ä¸èƒ½åŒæ—¶å‡ºç°ï¼‰</span></span><br><span class="line">    router.Use(cors.New(cors.Config&#123;</span><br><span class="line">        AllowOrigins:     []<span class="type">string</span>&#123;<span class="string">&quot;http://localhost:5173&quot;</span>&#125;,</span><br><span class="line">        AllowMethods:     []<span class="type">string</span>&#123;<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>&#125;,</span><br><span class="line">        AllowHeaders:     []<span class="type">string</span>&#123;<span class="string">&quot;Origin&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>&#125;,</span><br><span class="line">        ExposeHeaders:    []<span class="type">string</span>&#123;<span class="string">&quot;Content-Length&quot;</span>&#125;,</span><br><span class="line">        AllowCredentials: <span class="literal">true</span>,</span><br><span class="line">        MaxAge:           <span class="number">12</span>,</span><br><span class="line">    &#125;))</span><br><span class="line">	<span class="comment">// å…¶ä»–è·¯ç”±å¤„ç†é€»è¾‘</span></span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

                                            
                          </div>
                          <footer class="article-footer">
                            
<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Gin/" rel="tag">Gin</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li></ul>

                          </footer>

            </div>

            
              
<nav class="article-nav">
  
  <a href="/2024/04/25/Patrick%20Collins_blockchain_note/" class="article-nav-link">
    <strong class="article-nav-caption">å‰ä¸€ç¯‡</strong>
    <div class="article-nav-title">
      
      Patrick Collins-åŒºå—é“¾ ç¬”è®°
      
    </div>
  </a>
  
  
  <a href="/2024/03/17/Vue3_note/" class="article-nav-link">
    <strong class="article-nav-caption">åä¸€ç¯‡</strong>
    <div class="article-nav-title">Vue 3.0 ç¬”è®°</div>
  </a>
  
</nav>

                

                  
                    
                      
                        

</article>

<style>
  /* @font-face {
    font-family: 'SongHuiZongShouJinJiaCuBan-2';
    src: url("/css/songhuizong/SongHuiZongShouJinJiaCuBan-2.woff") format('woff'),
      url("/css/songhuizong/SongHuiZongShouJinJiaCuBan-2.ttf") format('truetype');
    font-weight: normal;
    font-style: normal;
  } */

  .article-inner {
    position: relative;
    overflow: hidden;
    /* ç¡®ä¿å†…å®¹ä¸ä¼šè¦†ç›–èƒŒæ™¯å›¾ */
  }

</style>
</section>
    
<footer class="footer">
  <div class="outer" style="display: inline-block;">
    <ul class="list-inline">
      <li>LRayçš„åšå®¢&nbsp;  |&nbsp; 2024</li><br>
      
        <li>
          
            <img src="/images/foot-logo.png"  style="width: 16px;">
            <a href="https://beian.miit.gov.cn/" target="_blank" style="text-decoration: none; color: rgba(0, 0, 0, 0.5);">
              çš–ICPå¤‡2024053806å·-1
            </a>
          
        </li><br>
      
      <li id="uptime">æœ¬ç«™å·²å®‰å…¨è¿è¡Œï¼š</li>
    </ul>
  </div>
</footer>

<script>
  // æ›´æ–°å¹¶å®æ—¶æ˜¾ç¤ºç«™ç‚¹è¿è¡Œæ—¶é•¿
  function updateUptime() {
    // è·å–ç½‘ç«™åˆ›å»ºæ—¶é—´ï¼Œè¿™é‡Œå‡è®¾ä½ æœ‰ä¸€ä¸ªå˜é‡æˆ–è€…å¸¸é‡å­˜å‚¨äº†ç½‘ç«™åˆ›å»ºæ—¶é—´
    var startDate = new Date('2024-04-28');
    
    // è®¡ç®—è¿è¡Œæ—¶é•¿
    var now = new Date();
    var uptime = now.getTime() - startDate.getTime();
    var seconds = Math.floor(uptime / 1000);
    var minutes = Math.floor(seconds / 60);
    var hours = Math.floor(minutes / 60);
    var days = Math.floor(hours / 24);
    
    // è®¡ç®—å‰©ä½™çš„å°æ—¶ã€åˆ†é’Ÿå’Œç§’æ•°
    hours %= 24;
    minutes %= 60;
    seconds %= 60;
    
    // æ›´æ–°é¡µé¢ä¸­çš„å…ƒç´ å†…å®¹
    var uptimeString = days + ' å¤©, ' + hours + ' å°æ—¶, ' + minutes + ' åˆ†é’Ÿ, ' + seconds + ' ç§’';
    document.getElementById('uptime').textContent = 'æœ¬ç«™å·²å®‰å…¨è¿è¡Œï¼š' + uptimeString;
  }
  
  // æ¯ç§’æ›´æ–°ä¸€æ¬¡è¿è¡Œæ—¶é•¿
  setInterval(updateUptime, 1000);
  
  // é¡µé¢åŠ è½½å®Œæˆåç«‹å³æ›´æ–°ä¸€æ¬¡
  updateUptime();
</script>
  </main>
  <aside class="sidebar">
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="https://lray-iu.oss-cn-hangzhou.aliyuncs.com/tenten.png" alt="LRayçš„åšå®¢" style="border-radius: 45px;"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/gallery">ç›¸å†Œ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/favorite">æ”¶è—</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/postcard">æ”¶é›†</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äº</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="æœç´¢">
        <i class="fe fe-search"></i>
        æœç´¢
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="æ‰‹æœºç«¯ä¼¼ä¹ä¸æ”¯æŒè¯¥åŠŸèƒ½ï¼Œæˆ‘æ·±æ„ŸæŠ±æ­‰">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>





<script src="/js/tocbot.min.js"></script>


<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  });
</script>



<script src="/js/ocean.js"></script>

</body>

</html>